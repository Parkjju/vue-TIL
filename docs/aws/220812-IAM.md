---
title: AWS IAM
---

## IAM

AWS 초기 가입 시 생성하는 루트계정은 계정 생성에만 사용해야 하며 반드시 IAM을 통해 서비스를 사용해야 합니다.

IAM 사용자는 특정 그룹에 속하게 됩니다. 이 그룹에는 `JSON` 형태로 권한을 부여하게 되며 그룹에 속한 사용자는 JSON에 명시된 권한들을 갖고 솔루션을 활용하게 됩니다. 이를 AWS에서 최소 권한 정책이라고 이야기합니다.

1. IAM 대시보드에 접속
2. 좌측 액세스 관리 메뉴의 사용자 메뉴 클릭
3. 사용자 추가 -> 사용자 추가 페이지로 이동
4. 사용자 이름 작성
5. AWS 액세스 유형 선택 - 액세스 키 또는 암호 선택
6. 콘솔 비밀번호 - 직접 입력
7. 비밀번호 재설정은 체크 해제, 다음페이지 이동
8. 그룹에 사용자 추가 탭 클릭
9. 그룹 생성 - AdministratorAccess (첫 번째 요소) 선택 후 생성 후 다음페이지 : 태그 이동
10. 태그 페이지에서 사용자 정보에 대한 간략한 태그 작성 (필수 아님) -> 검토 페이지로 이동
11. 계정 생성 후 `.csv` 파일을 반드시 받아줍니다. 생성한 IAM 계정 정보가 들어있으며 비밀번호 자동 생성을 선택했을 경우 csv 파일 내에 비밀번호 정보를 사용해야 합니다.

생성한 IAM 계정으로 로그인하기 위해서는 IAM 대시보드로 다시 돌아갑니다.

대시보드 우측에 AWS 계정이라는 섹션이 있고 계정 ID 및 별칭 섹션이 있습니다. 계정 ID로 로그인해도 되지만 별칭 설정을 통해 자동 생성된 URL로 로그인해도 됩니다.

:::warning IAM 별칭으로 로그인하기
IAM 별칭으로 생성된 URL을 가지고 로그인을 시도할 때에는 반드시 브라우저 시크릿 모드나 다른 브라우저를 통해 실행해야 합니다.

현재 루트 사용자로 로그인해둔 상태로 AWS IAM 사용자를 생성 및 로그인 시도를 하기 때문입니다.
:::

그룹 생성을 모두 마치고 루트 계정의 IAM 대시보드에서 생성한 그룹을 클릭, 생성한 IAM 사용자 추가를 진행하여 그룹에 사용자를 투입합니다.

## IAM 정책

IAM 그룹에 대한 정책은 그룹에 속한 사용자들에게 자동으로 상속됩니다. 어느 그룹에도 속하지 않거나 특정 사용자에 대한 권한 설정으로 inline 권한을 따로 부여할 수도 있습니다.

여러 그룹에 몸담고 있는 사용자는 여러 그룹에 대한 정책을 모두 상속받게 됩니다.

IAM 정책은 JSON으로 이루어져 있으며 구조는 다음과 같습니다.

```json
{
    "Version": "2022-10-17",
    "Id": "S3-Account-Permissions",
    "Statement": [
        {
            "Sid": "1",
            "Effect": "Allow",
            "Principal": {
                "AWS": ["arn:aws:iam::123456789012:root"]
            },
            "Action": ["s3:GetObject", "s3:PutObject"],
            "Resource": ["arn:aws:s3:::mybucket/*"]
        }
    ]
}
```

1. `Version`: IAM 정책 버전
2. `Id`: 정책 식별자 (선택사항)
3. `Statement`: 정책을 구성하는 문장 (**필수**)

`Statement`는 다음과 같은 내부 구조를 갖습니다.

1. `Sid`: 문장 식별자 (선택사항)
2. `Effect`: 문장이 특정 API에 대한 접근을 허용할지 여부에 대해 지정. `Deny`로 지정 가능
3. `Principal`: 정책이 적용될 계정 정보를 지정
4. `Action`: Effect가 적용되는 API 목록
5. `Resource`: action이 적용될 대상

IAM 계정 생성 및 초기 로그인 후 IAM 계정의 IAM 대시보드로 이동하면 접근 권한에 대한 에러가 페이지에 표시됩니다. 이때 루트 계정에서 해당 IAM 계정에 대한 IAM 대시보드 접근 권한을 부여해야 합니다.

IAM 계정에 대해 권한 부여를 하는 흐름은 다음과 같습니다.

1. 루트 계정에서 생성한 그룹에 사용자를 추가합니다. (그룹 정책 상속)
2. 루트 계정의 액세스 관리 - 사용자 탭으로 이동하여 생성한 IAM 계정 선택
3. 권한 탭 - 기존 정책 직접 연결 탭 - IAMReadOnlyAccess 권한 부여 (테스트용으로 권한은 아무거나 부여해도 상관 없음)
