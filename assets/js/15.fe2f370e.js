(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1092:function(t,a,e){"use strict";e.r(a);var s=e(6),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"strava-api-테스트"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#strava-api-테스트"}},[t._v("#")]),t._v(" Strava API 테스트")]),t._v(" "),a("p",[t._v("러닝 앱 빌드를 위해 스트라바 API를 사용하는 과정을 정리합니다.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developers.strava.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Strava Developers"),a("OutboundLink")],1),t._v(" 페이지로 이동합니다.")]),t._v(" "),a("p",[t._v("앱 생성 페이지로 이동하여 스트라바 API 호출을 위한 앱을 생성합니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(492),alt:"app"}})]),t._v(" "),a("p",[t._v("스트라바에서 제공하는 어플리케이션은 여러가지가 있지만 실질적인 러닝 관련 개인 데이터를 불러오기 위해서는 앱에 대한 스코프를 설정해야 합니다.")]),t._v(" "),a("p",[t._v("예를 들어 스트라바의 "),a("code",[t._v("List Athlete Activities")]),t._v("(/athlete/activities)를 활용하면 연결된 유저의 활동 내역을 얻어올 수 있습니다. 만들고자 하는 러닝 앱이 사용자 활동 트래킹과 관련된다면 폴리라인을 그려야 할 텐데, 이때 GET한 JSON 데이터의 "),a("code",[t._v("map")]),t._v(" 프로퍼티의 "),a("code",[t._v("summary_polyline")]),t._v(" 데이터를 디코딩 하면 지도상에 폴리라인을 그려낼 수 있게 됩니다.")]),t._v(" "),a("h2",{attrs:{id:"액세스토큰-발급-및-스코프-설정"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#액세스토큰-발급-및-스코프-설정"}},[t._v("#")]),t._v(" 액세스토큰 발급 및 스코프 설정")]),t._v(" "),a("p",[t._v("스트라바 앱 생성 후에는 기본적으로 액세스 토큰이 발급되기는 하지만 Auth설정이 된 액세스 토큰을 새로 발급받아야 위와 같은 데이터들을 실제로 활용할 수 있게 됩니다.")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://developers.strava.com/docs/getting-started/",target:"_blank",rel:"noopener noreferrer"}},[t._v("다음의 링크"),a("OutboundLink")],1),t._v("를 참조하여 권한 설정을 할 수 있습니다. API테스트는 포스트맨을 기반으로 진행합니다.")]),t._v(" "),a("p",[t._v("먼저 다음의 URL을 복사합니다.")]),t._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("http://www.strava.com/oauth/\nauthorize?client_id=[REPLACE_WITH_YOUR_CLIENT_ID]&amp;\nresponse_type=code&amp;\nredirect_uri=http://localhost/exchange_token&amp;approval_prompt=force&amp;scope=read\n")])])]),a("p",[t._v("이때 유의할 점은 URL파라미터의 가장 마지막에 있는 "),a("code",[t._v("scope")]),t._v("에 대한 값을 다르게 설정해줘야 한다는 것입니다. "),a("code",[t._v("read")]),t._v("로만 스코프 설정을 하게 되면 개인 데이터에는 접근할 수 없습니다.")]),t._v(" "),a("p",[t._v("스트라바 앱 생성 시 받은 클라이언트 아이디를 URL의 "),a("code",[t._v("[REPLACE_WITH_YOUR_CLIENT_ID]")]),t._v("에 복사하여 집어넣은 뒤 복사합니다.")]),t._v(" "),a("p",[t._v("이후 브라우저에 가서 위의 이상한 URL을 주소창에 입력합니다. 참고로 "),a("code",[t._v("/athlete/activities")]),t._v(" API를 활용하려면 "),a("code",[t._v("activity:read_all")]),t._v("스코프로 설정해야 합니다. 따라서 이번에 테스트용으로 얻어낼 권한과 클라이언트 아이디까지 합쳐 권한 승인 요청을 할 URL은 아래와 같습니다.")]),t._v(" "),a("p",[a("code",[t._v("http://www.strava.com/oauth/authorize?client_id=내꺼_클라이언트_아이디&response_type=code&redirect_uri=http://localhost/exchange_token&approval_prompt=force&scope=activity:read_all")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Strava API 스코프 확인하는 방법")]),t._v(" "),a("p",[t._v("다양한 스코프에 대한 내용은 스트라바 API playground 사이트에 접속하여 "),a("code",[t._v("Authorize")]),t._v("버튼을 클릭하여 확인합니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(493),alt:"play"}})]),t._v(" "),a("p",[a("img",{attrs:{src:e(494),alt:"auth"}})])]),t._v(" "),a("p",[t._v("위의 API Auth를 위한 URL로 접속을 시도하면 아래와 같은 화면이 나타납니다."),a("br"),t._v(" "),a("img",{attrs:{src:e(495),alt:"test"}})]),t._v(" "),a("p",[t._v("Authorize버튼을 클릭하면 권한 승인과 함께 스코프 설정이 완료된 액세스 토큰을 새로 발급받게 됩니다. 참고로 스트라바 API 앱 생성 시 앱에 대한 정보를 입력할 수 있는 공간이 있습니다. 아래 화면을 보겠습니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(496),alt:"update"}})]),t._v(" "),a("p",[t._v("Website는 "),a("code",[t._v("https")]),t._v(" 프로토콜로 시작하는 사이트 아무거나 입력하시면 되고, "),a("code",[t._v("Authorization Callback Domain")]),t._v("은 아래와 같이 "),a("code",[t._v("developers.strava.com")]),t._v("으로 합니다.")]),t._v(" "),a("p",[t._v("Authorize 버튼 클릭 후에는 로컬호스트로 접속하게 되며 주소창에 특별한 URL이 생기게 됩니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(497),alt:"exchange"}})]),t._v(" "),a("p",[t._v("URL 파라미터 중 "),a("code",[t._v("code")]),t._v("에 주목하여 권한승인을 통해 새로 발급받은 액세스 토큰을 복사하여 저장해둡니다.")]),t._v(" "),a("h2",{attrs:{id:"api-요청"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#api-요청"}},[t._v("#")]),t._v(" API 요청")]),t._v(" "),a("p",[a("strong",[t._v("API요청에 앞서 실제 데이터를 얻고 싶다면 스트라바 어플리케이션을 모바일에서 활용한 상태여야 합니다.")]),t._v(" 데이터가 조금이라도 쌓인 상태에서 진행해주세요.")]),t._v(" "),a("p",[t._v("Postman으로 접속합니다. 워크스페이스 생성 후 콜렉션 생성, 생성된 콜렉션을 우클릭하여 Add request를 클릭합니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(498),alt:"postman"}}),a("br"),t._v(" "),a("img",{attrs:{src:e(499),alt:"request"}})]),t._v(" "),a("p",[t._v("POST요청으로 리퀘스트를 생성합니다.")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST https://www.strava.com/oauth/token "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("client_id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("YOURCLIENTID "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("client_secret")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("YOURCLIENTSECRET "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("code")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("AUTHORIZATIONCODE "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-F")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("grant_type")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("authorization_code\n")])])]),a("p",[t._v("위의 내용은 cURL을 이용한 리퀘스트 형태인데 위의 의미는 URL이 "),a("code",[t._v("https://www.strava.com/oauth/token")]),t._v("이고 "),a("code",[t._v("client_id")]),t._v(", "),a("code",[t._v("client_secret")]),t._v(", "),a("code",[t._v("code")]),t._v(", "),a("code",[t._v("grant_type")]),t._v("이라는 URL 파라미터를 설정하여 POST요청을 보낸다는 뜻입니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(500),alt:"post"}})]),t._v(" "),a("p",[t._v("위와 같이 Params탭에 쿼리 파라미터들을 설정해줍니다. Value에 알맞는 값들을 넣어주면 되고 "),a("code",[t._v("code")]),t._v("에는 앞에서 로컬호스트 URL을 통해 발급받은 액세스 토큰을 집어넣으면 됩니다. "),a("code",[t._v("grant_type")]),t._v("은 이름 그대로 "),a("code",[t._v("autorization_code")]),t._v("로 작성하면 됩니다. 다른 값이 아닙니다!")]),t._v(" "),a("p",[t._v("모두 입력을 한 뒤 Send버튼을 클릭하면 아래와 같이 JSON 데이터를 받아올 수 있게 됩니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(501),alt:"json"}})]),t._v(" "),a("p",[t._v("성공적으로 JSON 데이터를 받아왔다면 "),a("code",[t._v("access_token")]),t._v(" 프로퍼티만 복사해서 저장합니다.")]),t._v(" "),a("p",[t._v("포스트맨 콜렉션에서 새로 Add request를 클릭하여 본격적으로 앱 활용을 위한 요청을 생성합니다. "),a("code",[t._v("https://www.strava.com/api/v3/athlete/activities")]),t._v(" URL로 GET 요청을 보내게 됩니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(502),alt:"activity"}})]),t._v(" "),a("p",[t._v("Auth탭의 Token에 권한 승인 후 날라온 JSON의 액세스 토큰을 복사하여 집어넣습니다. 모두 입력한 뒤 Send버튼을 클릭하면 API에 맞는 데이터들이 날라오게 됩니다.")]),t._v(" "),a("p",[a("img",{attrs:{src:e(503),alt:"result"}})])])}),[],!1,null,null,null);a.default=r.exports},492:function(t,a,e){t.exports=e.p+"assets/img/strava.5c696bbb.png"},493:function(t,a,e){t.exports=e.p+"assets/img/playground.b2def399.png"},494:function(t,a,e){t.exports=e.p+"assets/img/auth.9e663521.png"},495:function(t,a,e){t.exports=e.p+"assets/img/test.f726a2b1.png"},496:function(t,a,e){t.exports=e.p+"assets/img/update.6f493487.png"},497:function(t,a,e){t.exports=e.p+"assets/img/exchange.5147a288.png"},498:function(t,a,e){t.exports=e.p+"assets/img/postman.b344bea7.png"},499:function(t,a,e){t.exports=e.p+"assets/img/add.ecde923f.png"},500:function(t,a,e){t.exports=e.p+"assets/img/post.b57ea732.png"},501:function(t,a,e){t.exports=e.p+"assets/img/json.c925673f.png"},502:function(t,a,e){t.exports=e.p+"assets/img/activity.d3daaa76.png"},503:function(t,a,e){t.exports=e.p+"assets/img/result.a074cd39.png"}}]);